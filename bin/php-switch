#!/bin/bash

argument="$1"
version="5.6"
version_string="php56"

if [ -n "$argument" ] && [ $argument == "php55" ]; then
    version="5.5"
    version_string=$argument
fi

brew link --overwrite ${version_string} > /dev/null 2>&1
pear config-set php_ini /usr/local/etc/php/${version}/php.ini
ln -sf `brew list $version_string | grep libphp` /usr/local/lib/libphp5.so
ln -sf `brew list $version_string | grep 'bin/php$'` ~/bin/php

echo "Switched to $version."
echo "Restarting Apache."

# Kill all apache processes so the new libphp.so file is loaded correctly
sudo pkill -9 httpd

# Restart apache
sudo apachectl -k restart > /dev/null 2>&1

echo "Done!"
